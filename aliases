#!/bin/bash

# general
alias g='git'
alias v='vim'
alias vi='vim'
alias gpgme='gpg -e -u "matt@hiddenloop.com" -r "matt@hiddenloop.com"'
alias irc='ssh kessel -t "screen -x"'
alias con='tail -40 -f /var/log/system.log'
alias gpg='gpg2'
alias notes="vi ~/Dropbox/system/notes"
alias todos="vi ~/Dropbox/system/todos"
alias secrets="vi ~/Dropbox/system/secrets"

# https://github.com/trapd00r/ls--/issues/14
alias ll=' LC_ALL=en_US.UTF-8 LANG=en ls++ -a'

# quick project cds
alias cdpmf='cd /u/apps/faqtory'
alias cdpms='cd /u/apps/pmfaqtory-store'
alias cdbe='cd /u/apps/beyondendurance'
alias cdhbb='cd /u/apps/bugle'
alias cdwb='cd /u/code/workbench'

# HouseTrip
alias cdht='cd /u/apps/housetrip'
alias sdance='be rake smartling:push smartling:pull'
alias spush='be rake smartling:push'
alias spull='be rake smartling:pull'
alias myhtd='mysql housetrip_development'

# git commit extract PT story ID from branch name
function gc {
  if [ -n "$1" ]
  then
    PIVOTAL_STORY=$(echo $br | perl -ne 'print /-(\d+)$/')
    if [[ $1 =~ "[#$PIVOTAL_STORY]" ]]; then
      GIT_COMMIT_PT=$1
    else
      GIT_COMMIT_PT="[#$PIVOTAL_STORY] $1"
    fi;
    if [ -z $PIVOTAL_STORY ]; then
      GIT_COMMIT_PT=$1
    fi;

    git commit -am "$GIT_COMMIT_PT"
  else
    echo "usage: gc 'your commit message'"
  fi
}

# deploy to a staging
# e.g. sd 1 'some deploy message'
sd () {
  if [ -n "$1" ] && [ -n "$2" ]
  then
    ht staging-deploy "$2" --channel staging"$1" --staging staging"$1";
  else
    echo "usage: sd staging-server-number 'deploy message' e.g. sd 1 'awesome deploy'"
  fi
}

# migrate a staging
# e.g. sm 1
sm () {
  if [ -n "$1" ]
  then
    ht migrate staging"$1" --channel staging"$1";
  else
    echo "usage: sm staging-server-number e.g. sm 2"
  fi
}

# rails / ruby
alias gofast='ruby -i -pe "gsub /cache_classes \= (.+)$/, \"cache_classes = true\"" config/environments/development.rb'
alias goslow='ruby -i -pe "gsub /cache_classes \= (.+)$/, \"cache_classes = false\"" config/environments/development.rb'
alias tdl='tail -f ./log/development.log'
alias ttl='tail -f ./log/test.log'
alias rst='touch ./tmp/restart.txt'
alias rbenvit='rbenv shell `cat .ruby-version`'

# bundler / rake / spec / cucumber
alias be='bundle exec'
alias ss='bundle exec rails server'
alias sc='bundle exec rails console'
alias sg='bundle exec rails generate'
alias bes='bundle exec rspec'
alias bec='bundle exec cucumber'
alias rdbm='bundle exec rake db:migrate'
alias rdbp='bundle exec rake db:test:prepare'

# git
alias gb="git branch"
alias gg="git pull"
alias gp="git push"

# mysql
alias mysql='mysql -uroot'
alias mypmf='mysql faqtory_development'
